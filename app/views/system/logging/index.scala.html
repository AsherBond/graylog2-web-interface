@(currentUser: User, breadcrumbs: lib.BreadcrumbList, loggers: Map[Node, List[InternalLogger]])

@main("Logging", views.html.system.sidebar(), "", currentUser) {

    @views.html.partials.breadcrumbs(breadcrumbs)

    <div class="row-fluid">
        <h1><i class="icon icon-inbox"></i> Logging</h1>
        This section controls logging of the Graylog2 architecture. View logs generated by the system
        and change log levels here.
    </div>

    @for((node, nodeLoggers) <- loggers) {
        <div class="row-fluid log-writing-node node-row">
            <div class="pull-right">
                <a href="#" class="btn btn-mini btn-primary trigger-log-level-metrics" data-node-id="@node.getNodeId">
                    <i class="icon icon-dashboard"></i>
                    Metrics
                </a>

                <a href="#" class="btn btn-mini btn-primary trigger-fine-log-level-controls" data-node-id="@node.getNodeId">
                    <i class="icon icon-sort-by-alphabet"></i>
                    Log level control
                </a>
            </div>

            <h2>
                @views.html.partials.node_title_link(node)

                <span style="font-size: 12px;">
                    Has written a total of
                    <strong>
                        <span class="total-logs" data-node-id="@node.getNodeId">9001</span>
                        internal log messages.
                    </strong>
                </span>
            </h2>

            <div class="subsystems">
                <div class="subsystems-row">
                    @views.html.system.logging.partials.subsystem(node.getNodeId, "Graylog2", "Info", "All messages from graylog2-owned systems.")
                    @views.html.system.logging.partials.subsystem(node.getNodeId, "Indexer", "Info", "All messages related to indexing and searching.")
                    <br style="clear: both;" />
                </div>

                <div class="subsystems-row">
                    @views.html.system.logging.partials.subsystem(node.getNodeId, "Authentication", "Info", "All user authentication messages.")
                    @views.html.system.logging.partials.subsystem(node.getNodeId, "Sockets", "Info", "All messages related to socket communication.")
                    <br style="clear: both;" />
                </div>
            </div>

            <div class="loglevel-metrics" data-node-id="@node.getNodeId" style="display: none;">
                <div class="loglevel-metrics-row">
                    <div class="span4">
                        <h3 class="u-light">Level: Fatal</h3>
                        @views.html.system.logging.partials.loglevel_metrics()
                    </div>

                    <div class="span4">
                        <h3 class="u-light">Level: Error</h3>
                        @views.html.system.logging.partials.loglevel_metrics()
                    </div>

                    <div class="span4">
                        <h3 class="u-light">Level: Warn</h3>
                        @views.html.system.logging.partials.loglevel_metrics()
                    </div>
                </div>

                <div class="loglevel-metrics-row">
                    <div class="span4">
                        <h3 class="u-light">Level: Info</h3>
                        @views.html.system.logging.partials.loglevel_metrics()
                    </div>

                    <div class="span4">
                        <h3 class="u-light">Level: Debug</h3>
                        @views.html.system.logging.partials.loglevel_metrics()
                    </div>

                    <div class="span4">
                        <h3 class="u-light">Level: Trace</h3>
                        @views.html.system.logging.partials.loglevel_metrics()
                    </div>
                </div>
            </div>

            <div class="fine-log-level-controls" style="display: none;" data-node-id="@node.getNodeId">
                <dl>
                    <dt>
                        <label>
                            <input type="checkbox" class="select-all" data-node-id="@node.getNodeId"/>
                            Select all
                        </label>
                    </dt>
                    <dd>&nbsp;</dd>

                    @for(logger <- nodeLoggers.sortBy(_.getTitle)) {
                        <dt>
                            <label>
                                <input type="checkbox" value="@logger.getTitle" data-node-id="@node.getNodeId" />
                                @logger.getLevel.toUpperCase
                            </label>
                        </dt>
                        <dd>@logger.getTitle</dd>
                    }
                </dl>
            </div>
        </div>
    }
}